# Check if Docker is running
if ! docker info > /dev/null 2>&1; then
  echo "âš ï¸  Docker is not running. Skipping tests."
  echo "Please ensure Docker is running before pushing."
  exit 1
fi

# Check if containers are running
if ! docker-compose ps | grep -q "Up"; then
  echo "âš ï¸  Docker containers are not running. Skipping tests."
  echo "Please start containers with: docker-compose -f docker-compose.dev.yml up -d"
  exit 1
fi

echo "ğŸ” Running backend TypeScript check..."
if ! docker-compose exec -T backend npx tsc --noEmit; then
  echo "âŒ Backend TypeScript check failed!"
  exit 1
fi

echo "ğŸ§ª Running backend tests..."
if ! docker-compose exec -T backend npm test; then
  echo "âŒ Backend tests failed!"
  exit 1
fi

echo "ğŸ” Running frontend TypeScript check..."
if ! docker-compose exec -T frontend npx tsc --noEmit; then
  echo "âŒ Frontend TypeScript check failed!"
  exit 1
fi

echo "ğŸ§ª Running frontend tests..."
if ! docker-compose exec -T frontend npm test -- --run; then
  echo "âŒ Frontend tests failed!"
  exit 1
fi

echo "âœ… All checks passed!"
